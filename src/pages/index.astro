---
const siteTitle = "هوشینو — اولین پایگاه خبری مبتنی بر هوش مصنوعی";
---
<!DOCTYPE html>
<html lang="fa" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>{siteTitle}</title>
    <meta name="description" content="{siteTitle} | گردآوری، ترجمه و دسته‌بندی خودکار خبرها از منابع معتبر خارجی.">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🧠</text></svg>">
    <style>
      :root{
        --bg:#fafbff; --fg:#0e0f12; --mut:#6b7280;
        --card:#ffffff; --chip:#eef1f7; --border:#e5e7ef;
        --brand:#2563eb; --brand-weak:#e6efff; --shadow:0 10px 30px rgba(16,20,40,.08);
        --radius:16px;
      }
      *{box-sizing:border-box}
      html,body{margin:0;padding:0}
      body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Noto Sans',Tahoma,Arial;background:var(--bg);color:var(--fg);overflow-x:hidden;}
      a{color:inherit}
      .container{max-width:1100px;margin:0 auto;padding:12px}
      @media(min-width:640px){ .container{padding:16px} }
      header{position:sticky;top:0;backdrop-filter:blur(10px) saturate(120%);background:rgba(255,255,255,.92); border-bottom:1px solid var(--border); z-index:20;}
      .top{display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:space-between;padding:10px 0}
      .brand{display:flex;align-items:flex-start;gap:10px;min-width:0}
      .logo{font-size:24px;line-height:1}
      h1{margin:0;font-size:18px;line-height:1.35;word-break:break-word}
      .sub{margin:4px 0 0;color:var(--mut);font-size:12px}
      .actions{display:flex;gap:8px;align-items:center}
      .live{display:inline-flex;align-items:center;gap:6px;background:var(--brand-weak);color:#0c2a6e;padding:8px 12px;border-radius:999px;font-size:13px}
      .dot{width:8px;height:8px;background:#ef4444;border-radius:50%;position:relative;box-shadow:0 0 0 0 rgba(239,68,68,.6);animation:pulse 1.8s infinite}
      @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(239,68,68,.6)}70%{box-shadow:0 0 0 12px rgba(239,68,68,0)}100%{box-shadow:0 0 0 0 rgba(239,68,68,0)}}
      .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between;padding:8px 0 12px}
      .filters{display:flex;gap:8px;overflow:auto;padding-bottom:4px;-webkit-overflow-scrolling:touch}
      .chip{background:var(--chip); padding:10px 14px; border-radius:999px; font-size:14px; border:1px solid var(--border); white-space:nowrap; flex:0 0 auto; cursor:pointer}
      .chip.active{background:#1f4fff;color:#fff;border-color:#1f4fff}
      .search{flex:1;min-width:0;width:100%;background:#fff;border:1px solid var(--border);color:var(--fg); padding:12px;border-radius:12px}
      .ticker-wrap{position:relative;background:#fff;border-top:1px solid var(--border);border-bottom:1px solid var(--border);overflow:hidden}
      .ticker{display:flex;align-items:center;white-space:nowrap;overflow:hidden}
      .ticker-label{display:inline-flex;align-items:center;gap:6px;background:#ffe8e8;color:#8a1a1a;border-radius:999px;padding:6px 10px;margin-inline:8px;font-size:12px;flex:0 0 auto}
      .ticker-track{display:inline-flex;gap:28px;padding:10px 12px;min-width:100%;will-change:transform}
      .marqA{animation:marq 26s linear infinite}
      .marqB{animation:marq 26s linear infinite; animation-delay:13s}
      @keyframes marq{from{transform:translateX(0)}to{transform:translateX(-100%)}}
      .tick a{color:#0b3ddb;text-decoration:none;border-bottom:1px dashed #bcd;padding-bottom:1px;font-size:13px}
      .grid{display:grid; grid-template-columns:1fr; gap:12px; margin-top:12px}
      @media(min-width:640px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}
      @media(min-width:1024px){.grid{grid-template-columns:repeat(3,minmax(0,1fr))}}
      .card{background:var(--card); border:1px solid var(--border); border-radius:16px; overflow:hidden; box-shadow:var(--shadow);}
      .thumb{aspect-ratio:16/9; width:100%; background:linear-gradient(135deg,#eaf1ff,#f6f8ff);}
      .content{padding:14px}
      .meta{display:flex;gap:8px;align-items:center;margin-bottom:8px;color:var(--mut);font-size:12px;flex-wrap:wrap}
      .badge{background:#eef2ff;border:1px solid #dbe3ff; padding:4px 8px; border-radius:999px; font-size:12px;color:#29347a}
      .summary{color:#2b2b35;font-size:14px;line-height:1.7}
      .link{display:inline-flex;align-items:center;gap:6px;margin-top:10px;font-size:13px;color:#0b3ddb;text-decoration:none}
      .empty{color:var(--mut);font-size:13px;text-align:center;padding:30px 0}

      /* modal */
      .modal{position:fixed;inset:0;background:rgba(8,12,24,.45);display:none;align-items:flex-end;justify-content:center;z-index:50}
      @media(min-width:640px){.modal{align-items:center}}
      .sheet{width:100%;max-width:720px;background:#fff;border-radius:16px 16px 0 0;box-shadow:var(--shadow);overflow:hidden}
      @media(min-width:640px){.sheet{border-radius:16px}}
      .sheet-head{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--border)}
      .sheet-body{padding:16px}
      .sheet-title{font-size:16px;margin:0 0 4px 0}
      .sheet-meta{color:#6b7280;font-size:12px;margin-bottom:12px;display:flex;gap:10px;flex-wrap:wrap}
      .close{background:#f3f4f6;border:1px solid #e5e7ef;border-radius:10px;padding:8px 12px;cursor:pointer}
    </style>
  </head>
  <body>
    <header>
      <div class="container">
        <div class="top">
          <div class="brand">
            <div class="logo">🧠</div>
            <div>
              <h1>{siteTitle}</h1>
              <p class="sub">گردآوری، ترجمه و دسته‌بندی خودکار خبرها از منابع معتبر خارجی</p>
            </div>
          </div>
          <div class="actions">
            <span class="live"><span class="dot"></span> زنده</span>
          </div>
        </div>
        <div class="row">
          <div class="filters" id="filters">
            <button class="chip active" data-cat="all">همه</button>
            <button class="chip" data-cat="world">جهان</button>
            <button class="chip" data-cat="business">اقتصاد</button>
            <button class="chip" data-cat="science">علم</button>
            <button class="chip" data-cat="tech">تکنولوژی</button>
            <button class="chip" id="btn-refresh">رفرش</button>
          </div>
          <input class="search" id="search" placeholder="جستجو در عنوان/خلاصه...">
        </div>
      </div>
      <div class="ticker-wrap" aria-label="نوار تیترهای زنده">
        <div class="container" style="padding-top:0;padding-bottom:0">
          <div class="ticker">
            <span class="ticker-label">خبرهای جدید</span>
            <div class="ticker-track marqA" id="tickerA"></div>
            <div class="ticker-track marqB" id="tickerB" aria-hidden="true"></div>
          </div>
        </div>
      </div>
    </header>

    <main class="container">
      <div class="grid" id="grid"></div>
      <div id="empty" class="empty" style="display:none;">موردی یافت نشد.</div>
    </main>

    <!-- Modal Summary -->
    <div class="modal" id="modal">
      <div class="sheet">
        <div class="sheet-head">
          <strong>خلاصه خبر</strong>
          <button class="close" id="btn-close">بستن</button>
        </div>
        <div class="sheet-body">
          <h3 class="sheet-title" id="m-title"></h3>
          <div class="sheet-meta">
            <span id="m-source"></span>
            <span id="m-time"></span>
            <span id="m-cat"></span>
          </div>
          <p id="m-summary"></p>
          <p style="margin-top:10px"><a id="m-link" href="#" target="_blank" rel="noopener" class="link">مشاهده در منبع</a></p>
        </div>
      </div>
    </div>

    <footer style="text-align:center;opacity:.7;padding:24px 0;font-size:12px">© {siteTitle}</footer>

    <script type="module">
      const $grid=document.getElementById('grid');
      const $filters=document.getElementById('filters');
      const $search=document.getElementById('search');
      const $empty=document.getElementById('empty');
      const $btn=document.getElementById('btn-refresh');
      const $tickerA=document.getElementById('tickerA');
      const $tickerB=document.getElementById('tickerB');

      const $modal=document.getElementById('modal');
      const $mTitle=document.getElementById('m-title');
      const $mSource=document.getElementById('m-source');
      const $mTime=document.getElementById('m-time');
      const $mCat=document.getElementById('m-cat');
      const $mSummary=document.getElementById('m-summary');
      const $mLink=document.getElementById('m-link');
      const $btnClose=document.getElementById('btn-close');

      function timeAgo(iso){
        const ts=new Date(iso).getTime();
        const diff=Math.floor((Date.now()-ts)/1000);
        if(diff<60)return'همین الان';
        const m=Math.floor(diff/60); if(m<60)return m+' دقیقه پیش';
        const h=Math.floor(m/60); if(h<24) return h+' ساعت پیش';
        const d=Math.floor(h/24); return d+' روز پیش';
      }

      function openModal(item){
        $mTitle.textContent = item.titleFa || item.title;
        $mSource.textContent = 'منبع: ' + item.source;
        $mTime.textContent = timeAgo(item.publishedAt);
        $mCat.textContent = 'دسته: ' + (item.category || 'عمومی');
        $mSummary.textContent = item.summaryFa || item.summary || '—';
        $mLink.href = item.url;
        $modal.style.display = 'flex';
      }
      function closeModal(){ $modal.style.display='none'; }
      $btnClose.addEventListener('click', closeModal);
      $modal.addEventListener('click', (e)=>{ if(e.target===$modal) closeModal(); });

      function render(items){
        let list = items.slice();
        const active = $filters.querySelector('.chip[data-cat].active')?.getAttribute('data-cat') || 'all';
        const q = ($search.value||'').trim();
        if (active !== 'all') list = list.filter(i=>i.category===active);
        if (q) list = list.filter(i => (i.titleFa||'').includes(q) || (i.summaryFa||'').includes(q));

        list.sort((a,b)=> new Date(b.publishedAt) - new Date(a.publishedAt));

        $grid.innerHTML = list.map(i => `
          <article class="card" data-id="${i.id}" data-url="${i.url}">
            <div class="thumb"></div>
            <div class="content">
              <div class="meta">
                <span class="badge">${i.category||'general'}</span>
                <span>${timeAgo(i.publishedAt)}</span>
                <span>• ${i.source}</span>
              </div>
              <h3>${i.titleFa || i.title}</h3>
              <div class="summary">${i.summaryFa || i.summary || ''}</div>
              <a class="link" href="${i.url}" target="_blank" rel="noopener">مشاهده در منبع</a>
            </div>
          </article>
        `).join('');

        $empty.style.display = list.length ? 'none' : 'block';

        // card click -> open modal
        [...$grid.querySelectorAll('.card')].forEach(card=>{
          card.addEventListener('click', (e)=>{
            // avoid intercepting the source link click
            if (e.target.closest('a')) return;
            const id = card.getAttribute('data-id');
            const item = items.find(x=>x.id===id);
            if(item) openModal(item);
          });
        });

        // ticker
        const latest = items.slice().sort((a,b)=> new Date(b.publishedAt)-new Date(a.publishedAt)).slice(0,10);
        const line = latest.map(i=>`<span class="tick">• <a href="${i.url}" target="_blank" rel="noopener">${i.titleFa || i.title}</a></span>`).join('');
        $tickerA.innerHTML = line; $tickerB.innerHTML = line;
      }

      async function load(){
        try{
          const res = await fetch('articles.json', { cache:'no-store' });
          const data = await res.json();
          window.__ARTICLES__ = data;
          render(data);
        }catch(e){
          $grid.innerHTML = '<div class="empty">خطا در بارگذاری خبرها</div>';
        }
      }

      // filters
      $filters.addEventListener('click', (e)=>{
        const b = e.target.closest('.chip[data-cat]'); if(!b) return;
        [...$filters.querySelectorAll('.chip[data-cat]')].forEach(x=>x.classList.remove('active'));
        b.classList.add('active'); render(window.__ARTICLES__||[]);
      });
      $search.addEventListener('input', ()=> render(window.__ARTICLES__||[]) );

      // live feel
      setInterval(()=>{
        const items = window.__ARTICLES__||[];
        if(!items.length) return;
        const idx = Math.floor(Math.random()*items.length);
        items[idx].publishedAt = new Date().toISOString();
        render(items);
      }, 60000);

      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeModal(); });

      load();
      $btn?.addEventListener('click', load);
    </script>
  </body>
</html>
